var myApp=angular.module("myApp",["ngRoute"]);myApp.config(["$routeProvider","$locationProvider",function(e,o){o.hashPrefix(""),e.when("/home",{templateUrl:"/views/templates/home.html",controller:"LoginController"}).when("/register",{templateUrl:"/views/templates/register.html",controller:"LoginController"}).when("/user",{templateUrl:"/views/templates/user.html",controller:"UserController",resolve:{getuser:["UserService",function(e){return e.getuser()}]}}).when("/mainPage",{templateUrl:"/views/templates/mainPage.html",controller:"MainPageController",resolve:{getuser:["UserService",function(e){return e.getuser()}]}}).when("/myBookShelf",{templateUrl:"/views/templates/myBookShelf.html",controller:"MyBookShelfController",resolve:{getuser:["UserService",function(e){return e.getuser()}]}}).when("/otherBookShelves",{templateUrl:"/views/templates/otherBookShelves.html",controller:"OtherBookShelvesController",resolve:{getuser:["UserService",function(e){return e.getuser()}]}}).when("/bookResults",{templateUrl:"/views/templates/bookResults.html",controller:"BookResultsController",resolve:{getuser:["UserService",function(e){return e.getuser()}]}}).otherwise({redirectTo:"home"})}]),myApp.controller("BookResultsController",["$scope","$http","$location","UserService","ApiService",function(e,o,t,n,r){e.logout=n.logout;var l={};e.addBook=function(e){l=e,o.post("/books",l).then(function(e){console.log("Book Info Sent to Database"),l=""})},e.bookInfoFromApi=r.bookInfoFromApi}]),myApp.controller("HeaderController",["$scope","UserService",function(e,o){e.redirect=o.redirect,e.logout=o.logout,e.eventObject=o.eventObject}]),myApp.controller("LoginController",["$scope","$http","$location","UserService",function(e,o,t,n){e.user={username:"",password:""},e.login=function(){""===e.user.username||""===e.user.password?alert("You forgot to enter something in. Please enter your username and password."):o.post("/",e.user).then(function(e){e.data.username?t.path("/user"):alert("Your username or password was incorrect. Please try again.")})},e.registerUser=function(){""===e.user.username||""===e.user.password?alert("You forgot to enter something in. Please choose a username and password."):o.post("/register",e.user).then(function(e){t.path("/home")},function(e){alert("Please try again.")})}}]),myApp.controller("MainPageController",["$scope","$http","$location","UserService",function(e,o,t,n){e.logout=n.logout}]),myApp.controller("MyBookShelfController",["$scope","$http","$location","UserService","ApiService","MyBookShelfService",function(e,o,t,n,r,l){e.logout=n.logout,e.bookShelf={},l.getBookShelf(),e.findBook=function(){var o=e.bookToSearch.name;r.getBooks(o)},e.deleteBook=function(){var o=e.bookShelf.list;console.log("deleteBook button clicked"),console.log("the isbn of this book is: ",o)},e.bookToSearch=r.bookToSearch,e.bookShelf=l.bookShelf}]),myApp.controller("OtherBookShelvesController",["$scope","$http","$location","UserService",function(e,o,t,n){e.logout=n.logout}]),myApp.controller("UserController",["$scope","$http","$location","UserService",function(e,o,t,n){e.userObject=n.userObject,e.logout=n.logout}]),myApp.factory("ApiService",["$http","$location",function(e,o){var t={};return{bookInfoFromApi:t,getBooks:function(n){e.get("/googleBooksApi/"+n).then(function(e){t.response=e.data,console.log("Book Results From API: ",e.data.items),t.thumbnail=e.data.items[0].volumeInfo.imageLinks.thumbnail,t.smallThumbnail=e.data.items[0].volumeInfo.imageLinks.smallThumbnail,t.allowAnonLogging=e.data.items[0].volumeInfo.allowAnonLogging,t.authors=e.data.items[0].volumeInfo.authors[0],t.averageRating=e.data.items[0].volumeInfo.averageRating,t.canonicalVolumeLink=e.data.items[0].volumeInfo.canonicalVolumeLink,t.categories=e.data.items[0].volumeInfo.categories[0],t.contentVersion=e.data.items[0].volumeInfo.contentVersion,t.description=e.data.items[0].volumeInfo.description,t.isbn10=e.data.items[0].volumeInfo.industryIdentifiers[0].identifier,t.isbn13=e.data.items[0].volumeInfo.industryIdentifiers[1].identifier,t.infoLink=e.data.items[0].volumeInfo.infoLink,t.language=e.data.items[0].volumeInfo.language,t.pageCount=e.data.items[0].volumeInfo.pageCount,t.maturityRating=e.data.items[0].volumeInfo.maturityRating,t.previewLink=e.data.items[0].volumeInfo.previewLink,t.printType=e.data.items[0].volumeInfo.printType,t.publishedDate=e.data.items[0].volumeInfo.publishedDate,t.publisher=e.data.items[0].volumeInfo.publisher,t.ratingsCount=e.data.items[0].volumeInfo.ratingsCount,t.title=e.data.items[0].volumeInfo.title,o.path("/bookResults")})}}}]),myApp.factory("MyBookShelfService",["$http","$location",function(e,o){var t={};return{bookShelf:t,getBookShelf:function(){e.get("/books").then(function(e){t.list=e.data,console.log("books on bookshelf ",t.list)})}}}]),myApp.factory("UserService",["$http","$location",function(e,o){var t={};return{userObject:t,redirect:function(e){o.url(e)},getuser:function(){e.get("/user").then(function(e){e.data.username?t.userName=e.data.username:o.path("/home")})},logout:function(){e.get("/user/logout").then(function(e){o.path("/home")})}}}]);